#!/bin/sh
#===============================================================================
#
#          FILE:  tails-do-it
#
#         USAGE:  tails-do-it
#                 tails-do-it [/path/to/folder/with/bin]
#                     Instead of hardcoded paths, you can define custom
#                 tails-do-it /media/amnesia/TailsData/Persistent/bin
#                      This example uses bin from another TailsData_unlocked (USB Stick)
#
#   DESCRIPTION:  ---
#
#  INSTALLATION:  1. Have Tails Persistence/Dotfiles enabled
#                 2. Copy this file to /live/persistence/TailsData_unlocked/dotfiles/bin/tails-do-it
#                 3. Reboot (requires Unlocking the persistence) and then
#                    will be added to your PATH
#       OPTIONS:  [1] /path/to/folder/with/bin (defaults to /live/persistence/TailsData_unlocked/Persistent/bin/)
#  REQUIREMENTS:  ---
#          BUGS:  ---
#         NOTES:  ---
#        AUTHOR:  Emerson Rocha <rocha[at]ieee.org>
#       COMPANY:  Etica.AI
#       LICENSE:  Public Domain
#       VERSION:  1.1
#       CREATED:  2020-10-25 13:13 BRT v1.0 It works. Hardcoded paths
#      REVISION:  2020-10-25 19:36 UTC v1.1 Uses /home/amnesia/Persistent/bin as default
#===============================================================================

TIMESTAMP=$(date "+%Y-%m-%dT%T")

# TODO: implement custom path as primary parameter (fititnt, 2020-10-25 29:43 UTC)

DEFAULT_BIN_PATH="/home/amnesia/Persistent/bin"

if [ -e "$HOME/bin" ];
then
    echo "tails-do-it: $HOME/bin exists. Backup at $HOME/bin.$TIMESTAMP~"
    mv "$HOME/bin" "$HOME/bin.$TIMESTAMP~"
else
    echo "tails-do-it: WARNING! $HOME/bin already do not exist. You may need to add $HOME/bin to PATH"
    # echo 'PATH="/home/amnesia/Persistent/bin:$PATH"'
fi

set -e
ln -s "$DEFAULT_BIN_PATH" "$HOME/bin"
set +e